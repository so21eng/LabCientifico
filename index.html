<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eureka Lab - Â¡Descubre la Ciencia Divertida!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#00ADF2',
                    }
                }
            }
        }
    </script>
    <!-- Manifest para PWA -->
    <link rel="manifest" href="data:application/manifest+json,{%22name%22:%22Eureka%20Lab%22,%22short_name%22:%22EurekaLab%22,%22start_url%22:%22.%22,%22display%22:%22standalone%22,%22background_color%22:%22#ffffff%22,%22theme_color%22:%22#00ADF2%22,%22icons%22:[{%22src%22:%22data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACAAQMAAAD58POIAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgAAALAAAAA==%22,%22sizes%22:%22192x192%22,%22type%22:%22image/png%22}]}">
    <!-- Service Worker simple para offline -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:application/javascript,' + encodeURIComponent(`
                self.addEventListener('install', e => e.waitUntil(self.skipWaiting()));
                self.addEventListener('fetch', e => e.respondWith(fetch(e.request).catch(() => caches.match(e.request))));
            `));
        }
    </script>
    <style>
        .card-casero { @apply bg-green-200 border-green-500; }
        .card-intermedio { @apply bg-yellow-200 border-yellow-500; }
        .card-avanzado { @apply bg-red-200 border-red-500; }
        .particle { position: absolute; width: 5px; height: 5px; background: red; border-radius: 50%; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-100 to-purple-100 dark:from-gray-900 dark:to-gray-800 text-gray-900 dark:text-gray-100 min-h-screen flex flex-col transition-colors">
    <!-- Header llamativo -->
    <header class="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6 shadow-2xl">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <h1 class="text-4xl font-bold animate-pulse">ğŸ§ª Eureka Lab ğŸ§ª</h1>
            <div class="text-xl mt-4 md:mt-0">
                <div id="contador-completados" class="font-bold">Has completado 0/30 experimentos ğŸ…</div>
                <div id="racha-diaria" class="font-bold">Racha: 0 dÃ­as ğŸ”¥</div>
                <div id="nivel-global" class="font-bold">Nivel: Principiante</div>
            </div>
            <button id="toggle-dark" class="bg-white text-purple-600 px-4 py-2 rounded-full font-bold shadow-lg hover:scale-110 transition">ğŸŒ™ Modo Oscuro</button>
        </div>
    </header>
    <!-- NavegaciÃ³n colorida -->
    <nav class="bg-gradient-to-r from-green-500 to-blue-500 p-4 shadow-lg">
        <div class="container mx-auto flex flex-wrap justify-center gap-4">
            <button onclick="showSection('home')" class="bg-pink-600 hover:bg-pink-700 text-white px-6 py-3 rounded-full text-lg font-bold shadow-md hover:scale-105 transition">ğŸ  Home</button>
            <button onclick="showSection('catalogo')" class="bg-yellow-500 hover:bg-yellow-600 text-white px-6 py-3 rounded-full text-lg font-bold shadow-md hover:scale-105 transition">ğŸ“š CatÃ¡logo</button>
            <button onclick="showSection('quiz')" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-full text-lg font-bold shadow-md hover:scale-105 transition">â“ Quiz</button>
            <button onclick="showSection('adivina')" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-full text-lg font-bold shadow-md hover:scale-105 transition">ğŸ” Adivina</button>
            <button onclick="showSection('lab-virtual')" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-full text-lg font-bold shadow-md hover:scale-105 transition">ğŸ§‘â€ğŸ”¬ Lab Virtual</button>
            <button onclick="showSection('tabla-periodica')" class="bg-cyan-600 hover:bg-cyan-700 text-white px-6 py-3 rounded-full text-lg font-bold shadow-md hover:scale-105 transition">âš›ï¸ Tabla PeriÃ³dica</button>
            <button onclick="showSection('ranking')" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-full text-lg font-bold shadow-md hover:scale-105 transition">ğŸ† Ranking</button>
            <button onclick="showSection('mis-fotos')" class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-full text-lg font-bold shadow-md hover:scale-105 transition">ğŸ“¸ Mis Fotos</button>
        </div>
    </nav>
    <!-- Main -->
    <main class="container mx-auto p-6 flex-grow">
        <!-- Home / DesafÃ­o Diario -->
        <section id="home">
            <div id="desafio-diario" class="bg-gradient-to-r from-yellow-400 to-orange-500 p-8 rounded-2xl shadow-2xl text-center text-white text-2xl font-bold mb-8 animate-bounce"></div>
            <h2 class="text-3xl font-bold text-center mb-8">Â¡Bienvenido a Eureka Lab! Descubre la magia de la ciencia ğŸ§ªâœ¨</h2>
        </section>
        <!-- CatÃ¡logo -->
        <section id="catalogo" class="hidden">
            <h2 class="text-3xl font-bold text-center mb-6">CatÃ¡logo de Experimentos</h2>
            <div class="flex flex-col md:flex-row gap-4 mb-6">
                <input id="buscador" type="text" placeholder="ğŸ” Buscar experimento..." class="border-2 border-purple-500 rounded-full px-4 py-2 flex-grow">
                <select id="filtro-nivel" class="border-2 border-purple-500 rounded-full px-4 py-2">
                    <option value="">Todos los niveles</option>
                    <option value="Casero">ğŸŸ¢ Casero</option>
                    <option value="Intermedio">ğŸŸ¡ Intermedio</option>
                    <option value="Avanzado">ğŸ”´ Avanzado</option>
                </select>
            </div>
            <div id="lista-experimentos" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </section>
        <!-- Otras secciones placeholder mejorados -->
        <section id="quiz" class="hidden text-center">
            <h2 class="text-3xl font-bold mb-8">Quiz CientÃ­fico â“</h2>
            <div id="quiz-contenido" class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl max-w-2xl mx-auto"></div>
        </section>
        <section id="adivina" class="hidden text-center">
            <h2 class="text-3xl font-bold mb-8">Adivina el Experimento ğŸ”</h2>
            <div id="adivina-contenido" class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl max-w-2xl mx-auto"></div>
        </section>
        <section id="lab-virtual" class="hidden">
            <h2 class="text-3xl font-bold text-center mb-8">Laboratorio Virtual ğŸ§‘â€ğŸ”¬</h2>
            <div id="lab-lista" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </section>
        <!-- NUEVA SECCIÃ“N: Tabla PeriÃ³dica -->
        <section id="tabla-periodica" class="hidden">
            <h2 class="text-3xl font-bold text-center mb-8">Tabla PeriÃ³dica Interactiva âš›ï¸</h2>
            <div class="bg-white dark:bg-gray-800 p-8 rounded-3xl shadow-2xl max-w-7xl mx-auto">
                <p class="text-center mb-6 text-lg font-medium">Â¡Explora todos los elementos! Haz clic en cualquiera para ver sus propiedades, historia, usos, orbitales y mÃ¡s.</p>
                <iframe src="https://ptable.com/?lang=es" width="100%" height="800" class="rounded-xl border-4 border-purple-600 shadow-lg" allowfullscreen></iframe>
                <p class="text-center mt-6 text-sm text-gray-600 dark:text-gray-400">Fuente: <a href="https://ptable.com" target="_blank" class="underline hover:text-purple-600">Ptable.com</a> â€“ La tabla periÃ³dica mÃ¡s completa e interactiva</p>
            </div>
        </section>
        <section id="ranking" class="hidden">
            <h2 class="text-3xl font-bold text-center mb-8">Ranking de CientÃ­ficos ğŸ†</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div id="ranking-quiz" class="bg-gradient-to-b from-blue-400 to-blue-600 p-8 rounded-2xl shadow-2xl text-white"></div>
                <div id="ranking-adivina" class="bg-gradient-to-b from-purple-400 to-purple-600 p-8 rounded-2xl shadow-2xl text-white"></div>
            </div>
        </section>
        <section id="mis-fotos" class="hidden">
            <h2 class="text-3xl font-bold text-center mb-8">Mis Fotos de Experimentos ğŸ“¸</h2>
            <input type="file" accept="image/*" id="subir-foto" class="mb-8 border-4 border-dashed border-purple-500 p-4 rounded-2xl">
            <div id="galeria-fotos" class="grid grid-cols-2 md:grid-cols-4 gap-6"></div>
        </section>
    </main>
    <!-- Modal detallado -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-70 hidden flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 p-8 rounded-3xl shadow-2xl max-w-3xl w-full max-h-screen overflow-y-auto">
            <button onclick="closeModal()" class="float-right text-3xl text-red-600 hover:text-red-800">&times;</button>
            <div id="modal-contenido"></div>
        </div>
    </div>
    <!-- Sonidos libres (Mixkit - libres de derechos) -->
    <audio id="sound-correcto" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    <audio id="sound-error" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
    <audio id="sound-aplausos" src="https://assets.mixkit.co/sfx/preview/mixkit-small-crowd-applause-305.mp3"></audio>
    <audio id="sound-explosion" src="https://assets.mixkit.co/sfx/preview/mixkit-distant-explosion-1301.mp3"></audio>
    <audio id="sound-burbujas" src="https://assets.mixkit.co/sfx/preview/mixkit-bubbles-of-water-3003.mp3"></audio>
    <script>
        // 30 Experimentos completos (10 por nivel)
        const experimentos = [
            // Nivel Casero (10)
            {id:1, nombre:"VolcÃ¡n en ErupciÃ³n", nivel:"Casero", emoji:"ğŸŒ‹", materiales:["Bicarbonato", "Vinagre", "Colorante rojo", "Botella pequeÃ±a", "Plastilina"], pasos:["1. Modela un volcÃ¡n con plastilina alrededor de la botella.", "2. Pon bicarbonato dentro.", "3. AÃ±ade colorante y vinagre."], explicacion:"ReacciÃ³n Ã¡cido-base produce COâ‚‚ causando 'erupciÃ³n'.", video:"hxfzuwjJ7mM", pistas:["Hace espuma roja", "Simula lava", "Usa cocina comÃºn"], precauciones:["SupervisiÃ³n adulta", "No ingerir", "Al aire libre"], quizPregunta:"Â¿QuÃ© gas se produce?", quizOpciones:["OxÃ­geno","COâ‚‚","HidrÃ³geno","NitrÃ³geno"], quizCorrecta:1},
            {id:2, nombre:"Globo Autoinflable", nivel:"Casero", emoji:"ğŸˆ", materiales:["Globo", "Botella", "Vinagre", "Bicarbonato"], pasos:["1. Vinagre en botella.", "2. Bicarbonato en globo.", "3. Une y deja caer."], explicacion:"COâ‚‚ infla el globo.", video:"e92hp2i-DiI", pistas:["Se infla solo", "Sin soplar", "ReacciÃ³n quÃ­mica"], precauciones:["No ingerir"], quizPregunta:"Â¿Por quÃ© se infla?", quizOpciones:["Aire caliente","Gas COâ‚‚","Magia","Vapor"], quizCorrecta:1},
            {id:3, nombre:"LÃ¡mpara de Lava Casera", nivel:"Casero", emoji:"ğŸ«§", materiales:["Aceite", "Agua", "Colorante", "Tableta efervescente"], pasos:["1. Agua con colorante en vaso.", "2. Aceite encima.", "3. AÃ±ade tableta."], explicacion:"Densidad y reacciÃ³n producen burbujas.", video:"ppdl_zRB9N8", pistas:["Burbujas suben y bajan", "Colores flotan", "Como lava"], precauciones:["No ingerir"], quizPregunta:"Â¿Por quÃ© suben las burbujas?", quizOpciones:["Densidad","Gravedad","Calor","Magnetismo"], quizCorrecta:0},
            {id:4, nombre:"Arco Iris en un Vaso", nivel:"Casero", emoji:"ğŸŒˆ", materiales:["Miel", "JabÃ³n", "Agua", "Aceite", "Alcohol", "Colorantes"], pasos:["1. Verter capas cuidadosamente."], explicacion:"Diferentes densidades forman capas.", video:"46rIoI1ej_8", pistas:["Capas de colores", "No se mezclan", "LÃ­quidos apilados"], precauciones:["SupervisiÃ³n"], quizPregunta:"Â¿QuÃ© causa las capas?", quizOpciones:["Temperatura","Densidad","Color","Sabor"], quizCorrecta:1},
            {id:5, nombre:"Pimienta y JabÃ³n MÃ¡gico", nivel:"Casero", emoji:"âœ¨", materiales:["Plato con agua", "Pimienta", "JabÃ³n"], pasos:["1. Esparce pimienta.", "2. Toca con jabÃ³n."], explicacion:"TensiÃ³n superficial rota.", video:"MygnbvQy02w", pistas:["Pimienta huye", "Agua y jabÃ³n", "Superficie"], precauciones:["No ingerir"], quizPregunta:"Â¿QuÃ© propiedad cambia?", quizOpciones:["Densidad","TensiÃ³n superficial","Color","Temperatura"], quizCorrecta:1},
            {id:6, nombre:"Huevo Rebotador", nivel:"Casero", emoji:"ğŸ¥š", materiales:["Huevo", "Vinagre"], pasos:["1. Sumergir huevo en vinagre 24h."], explicacion:"Ãcido disuelve cÃ¡scara de carbonato.", video:"PGiqbtYnrVg", pistas:["Huevo sin cÃ¡scara", "Rebota", "Vinagre"], precauciones:["No ingerir", "SupervisiÃ³n"], quizPregunta:"Â¿QuÃ© disuelve la cÃ¡scara?", quizOpciones:["Agua","Ãcido","Base","Sal"], quizCorrecta:1},
            {id:7, nombre:"Flor que Cambia Color", nivel:"Casero", emoji:"ğŸŒ¸", materiales:["Flor blanca", "Agua", "Colorante"], pasos:["1. Poner en agua coloreada."], explicacion:"Capilaridad transporta color.", video:"w_o0hUiZdVA", pistas:["Flor se tiÃ±e", "Absorbe color", "Tallos"], precauciones:["Seguro"], quizPregunta:"Â¿CÃ³mo sube el color?", quizOpciones:["RaÃ­ces","Capilaridad","FotosÃ­ntesis","Gravedad"], quizCorrecta:1},
            {id:8, nombre:"Cohete de Vinagre", nivel:"Casero", emoji:"ğŸš€", materiales:["Botella", "Corcho", "Vinagre", "Bicarbonato"], pasos:["1. Bicarbonato en botella.", "2. Vinagre rÃ¡pido y tapa."], explicacion:"PresiÃ³n de gas lanza.", video:"qa3wQvHFN7k", pistas:["Vuela alto", "ReacciÃ³n rÃ¡pida", "Botella"], precauciones:["Al aire libre", "SupervisiÃ³n"], quizPregunta:"Â¿QuÃ© impulsa el cohete?", quizOpciones:["Fuego","Gas presiÃ³n","Alas","Electricidad"], quizCorrecta:1},
            {id:9, nombre:"Slime Casero", nivel:"Casero", emoji:"ğŸŸ¢", materiales:["Pegamento", "BÃ³rax", "Agua"], pasos:["1. Mezclar y amasar."], explicacion:"PolÃ­meros se entrecruzan.", video:"TV2HHpXGhYE", pistas:["ElÃ¡stico y viscoso", "Hecho en casa", "Pegajoso"], precauciones:["No ingerir"], quizPregunta:"Â¿QuÃ© es el slime?", quizOpciones:["LÃ­quido","SÃ³lido","PolÃ­mero no newtoniano","Gas"], quizCorrecta:2},
            {id:10, nombre:"Tornado en Botella", nivel:"Casero", emoji:"ğŸŒªï¸", materiales:["Dos botellas", "Cinta", "Agua"], pasos:["1. Unir botellas.", "2. Girar."], explicacion:"VÃ³rtice por movimiento.", video:"W0L6Sz90kcc", pistas:["Remolino de agua", "Dos botellas", "Gira"], precauciones:["Seguro"], quizPregunta:"Â¿QuÃ© forma el tornado?", quizOpciones:["Calor","Movimiento circular","PresiÃ³n","Magnetismo"], quizCorrecta:1},
            // Nivel Intermedio (10)
            {id:11, nombre:"Pasta de Dientes de Elefante", nivel:"Intermedio", emoji:"ğŸ¦·", materiales:["PerÃ³xido de hidrÃ³geno", "Levadura", "JabÃ³n", "Colorante"], pasos:["1. Mezclar y aÃ±adir levadura."], explicacion:"DescomposiciÃ³n catalÃ­tica libera oxÃ­geno.", video:"htLP188TRqM", pistas:["Espuma gigante", "Como dentÃ­frico", "ReacciÃ³n rÃ¡pida"], precauciones:["Guantes", "SupervisiÃ³n adulta obligatoria"], quizPregunta:"Â¿QuÃ© cataliza la reacciÃ³n?", quizOpciones:["Levadura","Ãcido","Calor","Luz"], quizCorrecta:0},
            {id:12, nombre:"Cristales de Sal", nivel:"Intermedio", emoji:"ğŸ§‚", materiales:["Sal", "Agua caliente", "Hilo", "Palo"], pasos:["1. Disolver sal en agua caliente.", "2. Suspender hilo."], explicacion:"CristalizaciÃ³n por evaporaciÃ³n.", video:"EwSziuC4HzI", pistas:["Cristales crecen", "Sal comÃºn", "Lento proceso"], precauciones:["Agua caliente"], quizPregunta:"Â¿CÃ³mo crecen los cristales?", quizOpciones:["Calentamiento","EvaporaciÃ³n","CongelaciÃ³n","Mezcla"], quizCorrecta:1},
            {id:13, nombre:"BaterÃ­a de LimÃ³n", nivel:"Intermedio", emoji:"ğŸ‹", materiales:["Limones", "Clavos", "Cables", "Monedas"], pasos:["1. Insertar electrodos en limones.", "2. Conectar en serie."], explicacion:"ReacciÃ³n electroquÃ­mica genera corriente.", video:"sXk2UZN1MP0", pistas:["Genera electricidad", "Fruta Ã¡cida", "Luces LED"], precauciones:["Cuidado con cortes"], quizPregunta:"Â¿QuÃ© produce la corriente?", quizOpciones:["Ãcido cÃ­trico","Agua","Sal","AzÃºcar"], quizCorrecta:0},
            {id:14, nombre:"CromatografÃ­a de Colores", nivel:"Intermedio", emoji:"ğŸ–ï¸", materiales:["Marcadores", "Papel filtro", "Agua"], pasos:["1. Dibujar en papel.", "2. Sumergir en agua."], explicacion:"SeparaciÃ³n por solubilidad.", video:"2X2X6P0V2k0", pistas:["Colores se separan", "Papel absorbe", "Tinta"], precauciones:["Seguro"], quizPregunta:"Â¿QuÃ© separa los colores?", quizOpciones:["Gravedad","Solubilidad","Densidad","Temperatura"], quizCorrecta:1},
            {id:15, nombre:"Densidad de LÃ­quidos", nivel:"Intermedio", emoji:"ğŸ¥¤", materiales:["Aceite", "Agua", "Miel", "Colorantes"], pasos:["1. Verter en capas."], explicacion:"Densidades diferentes estratifican.", video:"46rIoI1ej_8", pistas:["LÃ­quidos no mezclan", "Capas visibles", "Peso especÃ­fico"], precauciones:["No ingerir"], quizPregunta:"Â¿Por quÃ© forman capas?", quizOpciones:["Color","Densidad","Temperatura","Forma"], quizCorrecta:1},
            {id:16, nombre:"ReacciÃ³n de Iodo y AlmidÃ³n", nivel:"Intermedio", emoji:"ğŸ•°ï¸", materiales:["AlmidÃ³n", "Iodo", "Vitamina C"], pasos:["1. Mezclar almidÃ³n e iodo.", "2. AÃ±adir vitamina."], explicacion:"Complejo azul se decolora.", video:"5QqxwW0Eu48", pistas:["Reloj quÃ­mico", "Cambio color", "Tiempo preciso"], precauciones:["Guantes"], quizPregunta:"Â¿QuÃ© causa el cambio de color?", quizOpciones:["OxidaciÃ³n","ReducciÃ³n","Ãcido","Base"], quizCorrecta:1},
            {id:17, nombre:"Ã“smosis con Papas", nivel:"Intermedio", emoji:"ğŸ¥”", materiales:["Papas", "Agua salada", "Agua dulce"], pasos:["1. Cortar papas.", "2. Sumergir en soluciones."], explicacion:"Agua mueve por gradiente.", video:"xYWm_n3a_ak", pistas:["Papas cambian tamaÃ±o", "Agua entra/sale", "ConcentraciÃ³n"], precauciones:["Seguro"], quizPregunta:"Â¿QuÃ© es la Ã³smosis?", quizOpciones:["DifusiÃ³n de agua","EvaporaciÃ³n","ReacciÃ³n quÃ­mica","FotosÃ­ntesis"], quizCorrecta:0},
            {id:18, nombre:"Efecto Leidenfrost", nivel:"Intermedio", emoji:"ğŸ’§", materiales:["SartÃ©n caliente", "Agua"], pasos:["1. Calentar sartÃ©n.", "2. Gotear agua."], explicacion:"Vapor aisla gota.", video:"oYsB7wJxN1U", pistas:["Gota baila", "Calor extremo", "No se evapora rÃ¡pido"], precauciones:["SupervisiÃ³n, calor"], quizPregunta:"Â¿Por quÃ© la gota flota?", quizOpciones:["Vapor","Gravedad","Magnetismo","Densidad"], quizCorrecta:0},
            {id:19, nombre:"FermentaciÃ³n de Levadura", nivel:"Intermedio", emoji:"ğŸ", materiales:["Levadura", "AzÃºcar", "Agua tibia"], pasos:["1. Mezclar.", "2. Observar burbujas."], explicacion:"AnaerÃ³bica produce COâ‚‚.", video:"Y6fzQ7zD4xE", pistas:["Burbujas gas", "Pan sube", "Microorganismos"], precauciones:["No ingerir crudo"], quizPregunta:"Â¿QuÃ© gas produce la levadura?", quizOpciones:["OxÃ­geno","COâ‚‚","HidrÃ³geno","NitrÃ³geno"], quizCorrecta:1},
            {id:20, nombre:"Cristales Caseros", nivel:"Intermedio", emoji:"ğŸ’", materiales:["Sal o alumbre", "Agua caliente", "Hilo"], pasos:["1. SoluciÃ³n saturada.", "2. Suspender semilla."], explicacion:"Crecimiento por supersaturaciÃ³n.", video:"EwSziuC4HzI", pistas:["Crece cristales", "Lento", "Sal o azÃºcar"], precauciones:["Agua caliente cuidado"], quizPregunta:"Â¿QuÃ© causa crecimiento?", quizOpciones:["EvaporaciÃ³n","Calor","Luz","Gravedad"], quizCorrecta:0},
            // Nivel Avanzado (10)
            {id:21, nombre:"Motor ElÃ©ctrico Simple", nivel:"Avanzado", emoji:"âš¡", materiales:["Pila", "Cable", "ImÃ¡n", "Clavo"], pasos:["1. Bobina en clavo.", "2. Conectar."], explicacion:"Electromagnetismo genera movimiento.", video:"VgBugjQjibg", pistas:["Gira solo", "Electricidad e imÃ¡n", "Motor"], precauciones:["Cuidado electricidad"], quizPregunta:"Â¿QuÃ© principio usa?", quizOpciones:["Gravedad","Electromagnetismo","QuÃ­mica","Ã“ptica"], quizCorrecta:1},
            {id:22, nombre:"Espectroscopio Casero", nivel:"Avanzado", emoji:"ğŸŒˆ", materiales:["CD", "Caja", "Tubos"], pasos:["1. Construir con CD como difractor."], explicacion:"DifracciÃ³n de luz muestra espectro.", video:"p0M7kF0dT4U", pistas:["Ve colores luz", "Arco iris", "Ondas luminosas"], precauciones:["Cuidado cortes"], quizPregunta:"Â¿QuÃ© separa la luz?", quizOpciones:["RefracciÃ³n","DifracciÃ³n","ReflexiÃ³n","AbsorciÃ³n"], quizCorrecta:1},
            {id:23, nombre:"PÃ©ndulo de Newton", nivel:"Avanzado", emoji:"ğŸ”µ", materiales:["Bolas", "Hilos", "Soporte"], pasos:["1. Colgar bolas.", "2. Soltar una."], explicacion:"ConservaciÃ³n de momentum y energÃ­a.", video:"0j86cvLrDyM", pistas:["Bolas chocan", "EnergÃ­a transfiere", "FÃ­sica mecÃ¡nica"], precauciones:["Seguro"], quizPregunta:"Â¿QuÃ© se conserva?", quizOpciones:["Momentum","Temperatura","Color","Densidad"], quizCorrecta:0},
            {id:24, nombre:"Generador de Van de Graaff", nivel:"Avanzado", emoji:"ğŸ”Œ", materiales:["Botella", "Cinta", "Motor"], pasos:["1. Construir esfera conductora."], explicacion:"Acumula carga estÃ¡tica.", video:"Z8d5sTL69FY", pistas:["Chispas", "Electricidad estÃ¡tica", "Pelo erizado"], precauciones:["Alta tensiÃ³n"], quizPregunta:"Â¿QuÃ© acumula?", quizOpciones:["Carga elÃ©ctrica","Agua","Gas","Calor"], quizCorrecta:0},
            {id:25, nombre:"ReacciÃ³n de Clock de Iodo", nivel:"Avanzado", emoji:"â°", materiales:["Iodo", "Ãcido", "AlmidÃ³n"], pasos:["1. Mezclar reactivos."], explicacion:"ReacciÃ³n oscilante por cinÃ©tica.", video:"5QqxwW0Eu48", pistas:["Cambio color repentino", "Tiempo controlado", "QuÃ­mica compleja"], precauciones:["Guantes, supervisiÃ³n"], quizPregunta:"Â¿QuÃ© estudia esta reacciÃ³n?", quizOpciones:["CinÃ©tica quÃ­mica","BiologÃ­a","FÃ­sica","GeologÃ­a"], quizCorrecta:0},
            {id:26, nombre:"DestilaciÃ³n Simple", nivel:"Avanzado", emoji:"ğŸ¥ƒ", materiales:["Agua salada", "Matraz", "Condensador"], pasos:["1. Hervir y condensar."], explicacion:"SeparaciÃ³n por puntos de ebulliciÃ³n.", video:"dNs_zCUOa7g", pistas:["Purifica agua", "Vapor condensa", "SeparaciÃ³n mezclas"], precauciones:["Calor, supervisiÃ³n"], quizPregunta:"Â¿En quÃ© se basa la destilaciÃ³n?", quizOpciones:["Punto de ebulliciÃ³n","Densidad","Color","Sabor"], quizCorrecta:0},
            {id:27, nombre:"Efecto FotoelÃ©ctrico", nivel:"Avanzado", emoji:"â˜€ï¸", materiales:["Luz UV", "Electroscopio"], pasos:["1. Cargar y exponer a luz."], explicacion:"Luz libera electrones.", video:"kv7k2TQp15s", pistas:["Luz causa descarga", "Einstein explicÃ³", "Quantum"], precauciones:["UV cuidado"], quizPregunta:"Â¿QuÃ© libera la luz?", quizOpciones:["Electrones","Protones","Neutrones","Fotones"], quizCorrecta:0},
            {id:28, nombre:"SÃ­ntesis de Aspirina", nivel:"Avanzado", emoji:"ğŸ’Š", materiales:["Ãcido salicÃ­lico", "AnhÃ­drido acÃ©tico"], pasos:["1. Mezclar con catalizador."], explicacion:"EsterificaciÃ³n produce acetilsalicÃ­lico.", video:"Vq0oDGsDYis", pistas:["Medicamento comÃºn", "ReacciÃ³n orgÃ¡nica", "Ãcido"], precauciones:["QuÃ­micos, guantes"], quizPregunta:"Â¿QuÃ© tipo de reacciÃ³n es?", quizOpciones:["EsterificaciÃ³n","OxidaciÃ³n","ReducciÃ³n","PolimerizaciÃ³n"], quizCorrecta:0},
            {id:29, nombre:"Electroforesis de ADN", nivel:"Avanzado", emoji:"ğŸ§¬", materiales:["Gel agarosa", "Muestras ADN", "Voltaje"], pasos:["1. Preparar gel.", "2. Aplicar corriente."], explicacion:"MigraciÃ³n por carga y tamaÃ±o.", video:"2HgLpyWfIOY", pistas:["Separa fragmentos", "BiologÃ­a molecular", "Gel"], precauciones:["Electricidad, supervisiÃ³n"], quizPregunta:"Â¿QuÃ© separa el ADN?", quizOpciones:["TamaÃ±o y carga","Color","Densidad","Temperatura"], quizCorrecta:0},
            {id:30, nombre:"Modelo Pulmones", nivel:"Avanzado", emoji:"ğŸ«", materiales:["Botella", "Globos", "Pajitas"], pasos:["1. Construir diafragma con globo."], explicacion:"Simula inhalaciÃ³n por presiÃ³n.", video:"MygnbvQy02w", pistas:["Respira solo", "Globos pulmones", "Diafragma"], precauciones:["Seguro"], quizPregunta:"Â¿QuÃ© simula el globo inferior?", quizOpciones:["CorazÃ³n","Diafragma","TrÃ¡quea","Alveolos"], quizCorrecta:1}
        ];
        // LocalStorage
        let completados = JSON.parse(localStorage.getItem('completados')) || [];
        let favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];
        let puntos = parseInt(localStorage.getItem('puntos')) || 0;
        let racha = parseInt(localStorage.getItem('racha')) || 0;
        let ultimoDia = localStorage.getItem('ultimoDia') || '';
        let scoresQuiz = JSON.parse(localStorage.getItem('scoresQuiz')) || [];
        let scoresAdivina = JSON.parse(localStorage.getItem('scoresAdivina')) || [];
        let fotos = JSON.parse(localStorage.getItem('fotos')) || [];
        function playSound(id) { document.getElementById(id).play(); }
        function actualizarHeader() {
            document.getElementById('contador-completados').innerText = `Has completado ${completados.length}/30 experimentos ğŸ…`;
            document.getElementById('racha-diaria').innerText = `Racha: ${racha} dÃ­as ğŸ”¥`;
            document.getElementById('nivel-global').innerText = puntos < 100 ? 'Principiante' : puntos < 300 ? 'CientÃ­fico Junior' : 'CientÃ­fico Loco ğŸ§ ';
        }
        function desafioDiario() {
            const dia = new Date().getDate();
            const exp = experimentos[dia % 30];
            const div = document.getElementById('desafio-diario');
            div.innerHTML = `<h3 class="text-4xl">Â¡DesafÃ­o Diario! ${exp.emoji} ${exp.nombre}</h3><p class="text-xl">Â¡Hazlo hoy para mantener tu racha! ğŸ”¥</p><button onclick="mostrarModal(experimentos.find(e=>e.id===${exp.id}))" class="bg-white text-orange-600 px-8 py-4 rounded-full text-2xl mt-4 shadow-lg hover:scale-110">Â¡Vamos!</button>`;
        }
        function showSection(sec) {
            document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
            document.getElementById(sec).classList.remove('hidden');
            if (sec === 'catalogo') cargarCatalogo();
            if (sec === 'quiz') iniciarQuiz();
            if (sec === 'adivina') iniciarAdivina();
            if (sec === 'lab-virtual') cargarLabVirtual();
            if (sec === 'ranking') cargarRanking();
            if (sec === 'mis-fotos') cargarFotos();
            if (sec === 'home') desafioDiario();
        }
        function cargarCatalogo() {
            const lista = document.getElementById('lista-experimentos');
            lista.innerHTML = '';
            const bus = document.getElementById('buscador').value.toLowerCase();
            const niv = document.getElementById('filtro-nivel').value;
            experimentos.filter(e => e.nombre.toLowerCase().includes(bus) && (!niv || e.nivel === niv)).forEach(exp => {
                const cardClass = exp.nivel === 'Casero' ? 'card-casero' : exp.nivel === 'Intermedio' ? 'card-intermedio' : 'card-avanzado';
                const card = document.createElement('div');
                card.className = `border-4 ${cardClass} p-6 rounded-2xl shadow-xl cursor-pointer hover:scale-105 transition transform`;
                card.innerHTML = `<div class="text-6xl mb-4">${exp.emoji}</div><h3 class="text-2xl font-bold">${exp.nombre}</h3><p class="text-lg">${exp.nivel}</p>${completados.includes(exp.id) ? '<span class="text-green-600 text-xl">âœ” Completado</span>' : ''}`;
                card.onclick = () => mostrarModal(exp);
                lista.appendChild(card);
            });
        }
        function mostrarModal(exp) {
            document.getElementById('modal').classList.remove('hidden');
            const cont = document.getElementById('modal-contenido');
            cont.innerHTML = `
                <h2 class="text-4xl font-bold mb-4">${exp.emoji} ${exp.nombre}</h2>
                <p class="text-xl mb-4"><strong>Nivel:</strong> ${exp.nivel}</p>
                <p class="mb-4"><strong>Materiales:</strong> ${exp.materiales.join(', ')}</p>
                <p class="mb-4"><strong>Pasos:</strong><ol class="list-decimal ml-8">${exp.pasos.map(p => `<li class="text-lg">${p}</li>`).join('')}</ol></p>
                <p class="text-lg mb-4"><strong>ExplicaciÃ³n cientÃ­fica:</strong> ${exp.explicacion}</p>
                <p class="text-lg mb-4 text-red-600 font-bold"><strong>Precauciones:</strong> ${exp.precauciones.join(' â€¢ ')}</p>
                <iframe class="w-full h-64 rounded-xl mb-4" src="https://www.youtube.com/embed/${exp.video.split('v=')[1] || exp.video}" allowfullscreen></iframe>
                <div class="flex gap-4 mt-6">
                    <button id="completar-btn" class="bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-full text-xl shadow-lg hover:scale-110">Â¡Lo hice! ğŸ…</button>
                    <button id="favorito-btn" class="bg-yellow-500 hover:bg-yellow-600 text-white px-8 py-4 rounded-full text-xl shadow-lg hover:scale-110">â¤ï¸ Favorito</button>
                    <button onclick="navigator.share ? navigator.share({title: '${exp.nombre}', text: 'Â¡Mira este experimento!'}) : navigator.clipboard.writeText('Â¡Hice ${exp.nombre} en Eureka Lab!')" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-full text-xl shadow-lg hover:scale-110">Compartir ğŸš€</button>
                </div>
            `;
            document.getElementById('completar-btn').onclick = () => {
                if (!completados.includes(exp.id)) {
                    completados.push(exp.id);
                    localStorage.setItem('completados', JSON.stringify(completados));
                    puntos += exp.nivel === 'Avanzado' ? 30 : exp.nivel === 'Intermedio' ? 20 : 10;
                    localStorage.setItem('puntos', puntos);
                    playSound('sound-aplausos');
                    actualizarHeader();
                    cargarCatalogo();
                }
            };
        }
        function closeModal() { document.getElementById('modal').classList.add('hidden'); }
        // Lab Virtual con Canvas interactivo (ejemplos para primeros 10)
        const animaciones = {};

        class Particle {
            constructor(x, y, vx, vy, color, size, life) {
                this.x = x; this.y = y; this.vx = vx; this.vy = vy;
                this.color = color; this.size = size; this.life = life; this.age = 0;
            }
            update() { this.x += this.vx; this.y += this.vy; this.vy += 0.15; this.age++; }
            draw(ctx) {
                ctx.globalAlpha = 1 - this.age / this.life;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
            dead() { return this.age >= this.life; }
        }

        function cargarLabVirtual() {
            const lista = document.getElementById('lab-lista');
            lista.innerHTML = '';
            experimentos.forEach(exp => {
                const div = document.createElement('div');
                div.className = 'bg-gradient-to-b from-cyan-400 to-blue-600 p-8 rounded-3xl shadow-2xl text-center text-white';
                div.innerHTML = `
                    <h3 class="text-3xl font-bold mb-4">${exp.emoji} ${exp.nombre} Virtual</h3>
                    <canvas id="canvas-${exp.id}" width="400" height="300" class="bg-gray-900 rounded-xl mx-auto"></canvas>
                    <button onclick="iniciarAnim(${exp.id})" class="mt-4 bg-white text-blue-600 px-6 py-3 rounded-full text-xl font-bold shadow-lg hover:scale-110 transition">Â¡Iniciar SimulaciÃ³n!</button>
                `;
                lista.appendChild(div);
            });
        }

        function iniciarAnim(id) {
            const canvas = document.getElementById(`canvas-${id}`);
            const ctx = canvas.getContext('2d');
            let particles = [];
            let extra = { angle: 0, scale: 1, blobs: [], rocketY: 300 };

            if (animaciones[id]) cancelAnimationFrame(animaciones[id]);

            const loop = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                if (id === 1) { // VolcÃ¡n
                    playSound('sound-explosion');
                    for (let i = 0; i < 6; i++) {
                        particles.push(new Particle(200 + Math.random()*40-20, 260, Math.random()*6-3, -Math.random()*10-6, ['#ff4400','#ff8800','#ffff00'][Math.floor(Math.random()*3)], Math.random()*8+4, 90));
                    }
                } else if (id === 2) { // Globo
                    playSound('sound-burbujas');
                    extra.scale = Math.min(extra.scale + 0.015, 2.2);
                    ctx.fillStyle = '#ff69b4';
                    ctx.beginPath();
                    ctx.arc(200, 150, 80 * extra.scale, 0, Math.PI*2);
                    ctx.fill();
                } else if (id === 3) { // LÃ¡mpara lava
                    playSound('sound-burbujas');
                    if (Math.random() < 0.1 && extra.blobs.length < 12) {
                        extra.blobs.push({x: 100 + Math.random()*200, y: 300, r: 20 + Math.random()*30, vy: -0.8 - Math.random()*0.5});
                    }
                    extra.blobs.forEach(b => {
                        b.y += b.vy;
                        if (b.y < -b.r) b.y = 300 + b.r;
                        ctx.fillStyle = `hsl(${Math.random()*360},100%,50%)`;
                        ctx.beginPath();
                        ctx.arc(b.x, b.y, b.r, 0, Math.PI*2);
                        ctx.fill();
                    });
                } else if (id === 8) { // Cohete
                    playSound('sound-explosion');
                    extra.rocketY = Math.max(extra.rocketY - 8, -100);
                    ctx.fillStyle = '#gray';
                    ctx.fillRect(190, extra.rocketY, 20, 60);
                    particles.push(new Particle(200, extra.rocketY + 60, Math.random()*8-4, Math.random()*6+4, '#ff6600', Math.random()*6+3, 40));
                } else if (id === 11) { // Pasta elefante
                    playSound('sound-burbujas');
                    for (let i = 0; i < 12; i++) {
                        particles.push(new Particle(200 + Math.random()*60-30, 280, Math.random()*8-4, -Math.random()*12-4, '#ffffff', Math.random()*12+8, 120));
                    }
                } else if (id === 21) { // Motor
                    extra.angle += 0.25;
                    ctx.strokeStyle = '#ffff00';
                    ctx.lineWidth = 12;
                    ctx.beginPath();
                    ctx.arc(200, 150, 90, extra.angle, extra.angle + Math.PI*1.5);
                    ctx.stroke();
                } else { // GenÃ©rico divertido
                    playSound('sound-burbujas');
                    for (let i = 0; i < 4; i++) {
                        particles.push(new Particle(Math.random()*400, 300, Math.random()*6-3, -Math.random()*8, `hsl(${Math.random()*360},100%,60%)`, Math.random()*12+6, 100));
                    }
                }

                particles = particles.filter(p => {
                    p.update();
                    p.draw(ctx);
                    return !p.dead();
                });

                animaciones[id] = requestAnimationFrame(loop);
            };
            extra = { angle: 0, scale: 1, blobs: [], rocketY: 300 };
            particles = [];
            loop();
            // AÃ±ade mÃ¡s animaciones simples para otros (burbujas, colores, etc.)
        }
        // Quiz mejorado con selecciÃ³n de nivel
        function iniciarQuiz() {
            const cont = document.getElementById('quiz-contenido');
            cont.innerHTML = `
                <select id="nivel-quiz" class="border-2 border-purple-500 rounded-full px-4 py-2 mb-4">
                    <option value="Casero">ğŸŸ¢ Casero (10 pts por correcta)</option>
                    <option value="Intermedio">ğŸŸ¡ Intermedio (20 pts por correcta)</option>
                    <option value="Avanzado">ğŸ”´ Avanzado (30 pts por correcta)</option>
                </select>
                <button onclick="generarQuiz()" class="bg-purple-600 text-white px-8 py-4 rounded-full text-2xl shadow-lg hover:scale-110">Â¡Empezar Quiz! ğŸš€</button>
            `;
        }
        function generarQuiz() {
            const nivel = document.getElementById('nivel-quiz').value;
            let score = 0;
            let current = 0;
            const preguntas = experimentos.filter(e => e.nivel === nivel);
            const puntosPorCorrecta = nivel === 'Avanzado' ? 30 : nivel === 'Intermedio' ? 20 : 10;
            const cont = document.getElementById('quiz-contenido');
            const showPreg = () => {
                if (current >= 10) {
                    playSound('sound-aplausos');
                    const nombre = prompt('Â¡Felicidades! PuntuaciÃ³n: ' + score + '. Ingresa tu nombre:');
                    scoresQuiz.push({nombre, score, nivel});
                    scoresQuiz.sort((a,b) => b.score - a.score);
                    localStorage.setItem('scoresQuiz', JSON.stringify(scoresQuiz));
                    cont.innerHTML = `<h3 class="text-4xl">Â¡Fin! ${score} pts ğŸ†</h3>`;
                    cargarRanking();
                    return;
                }
                const p = preguntas[current];
                cont.innerHTML = `<h3 class="text-2xl mb-8">${p.quizPregunta}</h3><div class="grid grid-cols-2 gap-4">${p.quizOpciones.map((op,i) => `<button onclick="responder(${i}, ${p.quizCorrecta}, ${puntosPorCorrecta})" class="bg-blue-500 hover:bg-blue-600 text-white py-4 rounded-xl text-xl shadow-lg">${op}</button>`).join('')}</div>`;
            };
            window.responder = (sel, correcta, pts) => {
                if (sel === correcta) { score += pts; playSound('sound-correcto'); } else playSound('sound-error');
                current++;
                showPreg();
            };
            showPreg();
        }
        // Adivina el Experimento con niveles y alternativas
        function iniciarAdivina() {
            const cont = document.getElementById('adivina-contenido');
            cont.innerHTML = `
                <select id="nivel-adivina" class="border-2 border-purple-500 rounded-full px-4 py-2 mb-4">
                    <option value="Casero">ğŸŸ¢ Casero (10 pts por correcta)</option>
                    <option value="Intermedio">ğŸŸ¡ Intermedio (20 pts por correcta)</option>
                    <option value="Avanzado">ğŸ”´ Avanzado (30 pts por correcta)</option>
                </select>
                <button onclick="generarAdivina()" class="bg-purple-600 text-white px-8 py-4 rounded-full text-2xl shadow-lg hover:scale-110">Â¡Empezar Adivinanza! ğŸ”</button>
            `;
        }
        function generarAdivina() {
            const nivel = document.getElementById('nivel-adivina').value;
            let score = 0;
            let current = 0;
            const adivinanzas = experimentos.filter(e => e.nivel === nivel);
            const puntosPorCorrecta = nivel === 'Avanzado' ? 30 : nivel === 'Intermedio' ? 20 : 10;
            const cont = document.getElementById('adivina-contenido');
            const showAdiv = () => {
                if (current >= 10) {
                    playSound('sound-aplausos');
                    const nombre = prompt('Â¡Felicidades! PuntuaciÃ³n: ' + score + '. Ingresa tu nombre:');
                    scoresAdivina.push({nombre, score, nivel});
                    scoresAdivina.sort((a,b) => b.score - a.score);
                    localStorage.setItem('scoresAdivina', JSON.stringify(scoresAdivina));
                    cont.innerHTML = `<h3 class="text-4xl">Â¡Fin! ${score} pts ğŸ†</h3>`;
                    cargarRanking();
                    return;
                }
                const a = adivinanzas[current];
                // Generar opciones: el correcto y 3 random de otros experimentos del mismo nivel
                const opciones = [a.nombre];
                const otros = experimentos.filter(e => e.nivel === nivel && e.id !== a.id).sort(() => Math.random() - 0.5).slice(0,3).map(e => e.nombre);
                opciones.push(...otros);
                opciones.sort(() => Math.random() - 0.5);
                const correcta = opciones.indexOf(a.nombre);
                cont.innerHTML = `<h3 class="text-2xl mb-4">Pistas: ${a.pistas.join(' â€¢ ')}</h3><h3 class="text-2xl mb-8">Â¿QuÃ© experimento es?</h3><div class="grid grid-cols-2 gap-4">${opciones.map((op,i) => `<button onclick="responderAdiv(${i}, ${correcta}, ${puntosPorCorrecta})" class="bg-purple-500 hover:bg-purple-600 text-white py-4 rounded-xl text-xl shadow-lg">${op}</button>`).join('')}</div>`;
            };
            window.responderAdiv = (sel, correcta, pts) => {
                if (sel === correcta) { score += pts; playSound('sound-correcto'); } else playSound('sound-error');
                current++;
                showAdiv();
            };
            showAdiv();
        }
        function cargarRanking() {
            // Top 3 con tÃ­tulos
            const titles = ['ğŸ† Maestro CientÃ­fico Supremo', 'ğŸ¥ˆ Experto en Reacciones', 'ğŸ¥‰ Genio de los Experimentos'];
            document.getElementById('ranking-quiz').innerHTML = '<h3>Quiz</h3>' + scoresQuiz.slice(0,3).map((s,i) => `<p>${titles[i]} ${s.nombre}: ${s.score} (${s.nivel})</p>`).join('');
            document.getElementById('ranking-adivina').innerHTML = '<h3>Adivina</h3>' + scoresAdivina.slice(0,3).map((s,i) => `<p>${titles[i]} ${s.nombre}: ${s.score} (${s.nivel})</p>`).join('');
        }
        function cargarFotos() {
            const gal = document.getElementById('galeria-fotos');
            gal.innerHTML = '';
            fotos.forEach(src => {
                const img = document.createElement('img');
                img.src = src;
                img.className = 'rounded-2xl shadow-xl hover:scale-110 transition';
                gal.appendChild(img);
            });
        }
        document.getElementById('subir-foto').onchange = e => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = ev => {
                fotos.push(ev.target.result);
                localStorage.setItem('fotos', JSON.stringify(fotos));
                cargarFotos();
            };
            reader.readAsDataURL(file);
        };
        document.getElementById('toggle-dark').onclick = () => document.body.classList.toggle('dark');
        // Init
        actualizarHeader();
        showSection('home');
        document.getElementById('buscador').oninput = cargarCatalogo;
        document.getElementById('filtro-nivel').onchange = cargarCatalogo;
    </script>
</body>
</html>
